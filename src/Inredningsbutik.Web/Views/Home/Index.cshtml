@model Inredningsbutik.Web.ViewModels.HomeIndexVm

<div class="page-wrap">

<!-- HERO -->
<section class="hero-editorial mb-4 fade-up">
  <div class="hero-editorial__media hero-editorial__media--video" aria-hidden="true">
    <video id="heroVideo" class="hero-editorial__video" autoplay muted playsinline preload="auto">
      <source src="/videos/hero.mp4" type="video/mp4" />
    </video>
    <div class="hero-editorial__videoOverlay"></div>

  </div>

  <div class="hero-editorial__inner">
    <div class="hero-editorial__copy">
      <h1 class="hero-editorial__title">Skandinavisk inredning</h1>
      <p class="hero-editorial__lead">
        Upptäck noga utvalda detaljer för ett lugnt, stilrent hem. Handplockat för en tidlös känsla.
      </p>

<a class="btn hero-editorial__cta" href="#produkter">
  <span class="cta-text">Handla här</span>
</a>
    </div>
  </div>
</section>

<!-- USP / Fördelar -->
<section class="usp-strip" aria-label="Fördelar">
  <div class="container-fluid usp-strip__inner">
    
    <div class="usp-item">
      <img class="usp-item__icon" src="/images/icons/sortimentikon.png" alt="" aria-hidden="true" />
      <div class="usp-item__text">
        <div class="usp-item__title">Handplockat sortiment</div>
        <div class="usp-item__desc">Noggrant utvalda favoriter för ett tidlöst hem.</div>
      </div>
    </div>

    <div class="usp-item">
      <img class="usp-item__icon" src="/images/icons/leveransikon.png" alt="" aria-hidden="true" />
      <div class="usp-item__text">
        <div class="usp-item__title">Fri frakt</div>
        <div class="usp-item__desc">Snabb leverans – alltid utan extra kostnad.</div>
      </div>
    </div>

    <div class="usp-item">
      <img class="usp-item__icon" src="/images/icons/returikon.png" alt="" aria-hidden="true" />
      <div class="usp-item__text">
        <div class="usp-item__title">30 dagars retur</div>
        <div class="usp-item__desc">Handla tryggt med smidig och enkel retur.</div>
      </div>
    </div>

  </div>
</section>

<div id="productResults">
<div class="catalog-layout">

  <!-- VÄNSTER: KATEGORIER -->
  <aside class="catalog-filters" aria-label="Kategorifilter">

<div class="catalog-filters__groups">
  @foreach (var g in Model.CategoryGroups)
  {
    <div class="catalog-filters__group">
      <div class="catalog-filters__groupTitle">@g.Title</div>

      <ul class="catalog-filters__list">
        @foreach (var item in g.Items)
        {
          var isActive = item.Id == null
            ? Model.CategoryId == null
            : Model.CategoryId == item.Id;

          <li>
            <a class="catalog-filters__link @(isActive ? "is-active" : "")"
               asp-area="" asp-controller="Home" asp-action="Index"
               asp-route-categoryId="@item.Id"
               asp-route-q="@Model.Q">
              <span class="catalog-filters__linkText">@item.Name</span>
              <span class="catalog-filters__count">@item.ProductCount</span>
            </a>
          </li>
        }
      </ul>
    </div>
  }
</div>


    @if (Model.CategoryId.HasValue || !string.IsNullOrWhiteSpace(Model.Q))
    {
      <a class="catalog-filters__clear"
         asp-area="" asp-controller="Home" asp-action="Index">
        Rensa filter
      </a>
    }
  </aside>

  <!-- HÖGER: PRODUKTER -->
  <section class="catalog-content">
    <div class="d-flex justify-content-between align-items-end mb-2 fade-up" id="produkter">
      <div>
@{
  var selectedName = Model.CategoryId.HasValue
    ? Model.Categories.FirstOrDefault(c => c.Id == Model.CategoryId)?.Name
    : "Alla produkter";
}
<h2 class="catalog-content__title mb-0">@selectedName (@Model.Products.Count)</h2>

      </div>
    </div>

    <div class="row g-3">
      @foreach (var p in Model.Products)
      {
        <div class="col-12 col-sm-6 col-lg-4 col-xl-3 fade-up">
          <div class="product-card">
            <a asp-area="" asp-controller="Catalog" asp-action="Details" asp-route-id="@p.Id" style="text-decoration:none; color:inherit;">
              <div class="product-media">
                <img class="base" src="@(string.IsNullOrWhiteSpace(p.ImageUrl) ? "/images/placeholder.jpg" : p.ImageUrl)" alt="@p.Name" />
                <img class="hover" src="@(string.IsNullOrWhiteSpace(p.HoverImageUrl) ? (string.IsNullOrWhiteSpace(p.ImageUrl) ? "/images/placeholder.jpg" : p.ImageUrl) : p.HoverImageUrl)" alt="@p.Name inspirationsbild" />
              </div>

              <div class="product-body">
                <div class="product-title">@p.Name</div>
<div class="product-meta">
  <form asp-area="" asp-controller="Cart" asp-action="Add" method="post" class="product-add">
    @Html.AntiForgeryToken()
    <input type="hidden" name="productId" value="@p.Id" />
    <input type="hidden" name="quantity" value="1" />
    <input type="hidden" name="returnUrl" value="@(Context.Request.Path + Context.Request.QueryString)" />

    <button type="submit" class="product-add__btn" aria-label="Lägg @p.Name i varukorgen" title="Lägg i varukorgen">
      <img src="images/icons/köpikon.png" alt="" aria-hidden="true" />
    </button>
  </form>

  <span class="product-price"><strong>@p.Price.ToString("0.00") kr</strong></span>
</div>

              </div>
            </a>
          </div>
        </div>
      }
    </div>
  </section>

</div>
</div>