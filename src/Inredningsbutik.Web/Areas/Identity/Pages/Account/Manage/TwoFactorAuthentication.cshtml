@page
@model TwoFactorAuthenticationModel
@{
    ViewData["Title"] = "Tvåfaktorsautentisering";
    ViewData["ActivePage"] = ManageNavPages.TwoFactorAuthentication;
}

<div class="identity-page">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-10">
            <div class="identity-card">
                <h1 class="mb-4">Hantera konto</h1>

                <div class="row">
                    <div class="col-md-3 mb-4">
                        <partial name="_ManageNav" />
                    </div>

                    <div class="col-md-9">
                        <h2 class="h5 mb-3">@ViewData["Title"]</h2>

                        <partial name="_StatusMessage" for="StatusMessage" />

                        @if (Model.Is2faEnabled)
                        {
                            <div class="alert alert-info">
                                Tvåfaktorsautentisering är aktiverad för ditt konto.
                            </div>

                            @if (Model.RecoveryCodesLeft == 0)
                            {
                                <div class="alert alert-danger">
                                    Du har inga återställningskoder kvar.
                                </div>
                            }
                            else if (Model.RecoveryCodesLeft == 1)
                            {
                                <div class="alert alert-warning">
                                    Du har 1 återställningskod kvar.
                                </div>
                            }
                            else if (Model.RecoveryCodesLeft <= 3)
                            {
                                <div class="alert alert-warning">
                                    Du har @Model.RecoveryCodesLeft återställningskoder kvar.
                                </div>
                            }

                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <a asp-page="./Disable2fa" class="btn btn-primary">
                                    Inaktivera 2FA
                                </a>

                                <a asp-page="./GenerateRecoveryCodes" class="btn btn-primary">
                                    Generera nya återställningskoder
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-secondary">
                                Tvåfaktorsautentisering är inte aktiverad.
                            </div>
                        }

                        <hr class="my-4" />

                        @if (!Model.HasAuthenticator)
                        {
                            <p class="mb-3">
                                Du har ingen autentiseringsapp konfigurerad.
                            </p>

                            <a asp-page="./EnableAuthenticator" class="btn btn-primary">
                                Lägg till autentiseringsapp
                            </a>
                        }
                        else
                        {
                            <p class="mb-3">
                                Autentiseringsapp är konfigurerad.
                            </p>

                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <a asp-page="./EnableAuthenticator" class="btn btn-primary">
                                    Konfigurera om autentiseringsapp
                                </a>

                                <a asp-page="./ResetAuthenticator" class="btn btn-primary">
                                    Återställ autentiseringsnyckel
                                </a>
                            </div>
                        }

                        <hr class="my-4" />

                        @if (Model.IsMachineRemembered)
                        {
                            <form method="post" asp-page-handler="ForgetBrowser">
                            @Html.AntiForgeryToken()
                                <button type="submit" class="btn btn-link p-0">
                                    Glöm denna enhet (kräv 2FA här nästa gång)
                                </button>
                            </form>
                        }
                        else
                        {
                            <p class="text-muted mb-0">
                                Denna enhet är inte markerad som betrodd.
                            </p>
                        }

                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
